# -*- coding: utf-8 -*-
"""Prediction_of_Disease_Outbreaks(Heart).ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1nk4L4LCO8SMqk15Z0pw9QUtU0s_lI9hJ
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.preprocessing import StandardScaler
from sklearn.preprocessing import LabelEncoder
from sklearn.model_selection import train_test_split
from sklearn import svm
from sklearn.svm import SVC
from sklearn.metrics import accuracy_score,classification_report, confusion_matrix
from mlxtend.plotting import plot_decision_regions

from google.colab import files
files.upload()

data=pd.read_csv('heart.csv')

data

type(data)

data.head()

data.tail()

data.shape

data.describe()

"""Data Preprocessing"""

data['target'].value_counts

data.groupby('target').mean()

x=data.drop(columns='target',axis=1)
y=data['target']

print(x)

print(y)

"""Data Standardization"""

model=StandardScaler()

model.fit(x)

standardized_data=model.transform(x)

x=standardized_data
y=data['target']

print(x)

print(y)

"""Train and test split"""

x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.1,stratify=y,random_state=2)

print(x.shape,x_train.shape,x_test.shape)

classifier=svm.SVC(kernel='linear')

"""training the svm"""

classifier.fit(x_train,y_train)

"""accuracy on training data"""

x_train_prediction=classifier.predict(x_train)
training_data_accuracy=accuracy_score(x_train_prediction,y_train)

print('accuracy on training data:',training_data_accuracy)

x_test_prediction=classifier.predict(x_test)
test_data_accuracy=accuracy_score(x_test_prediction,y_test)

print('accuracy on test data:',test_data_accuracy)

input_data=(50,0,2,120,219,0,1,158,0,1.6,1,0,2)
input_data_as_numpy_array=np.asarray(input_data)
input_data_reshaped=input_data_as_numpy_array.reshape(1,-1)
prediction=classifier.predict(input_data_reshaped)
print(prediction)

if(prediction[0]==1):
  print('The person is having heart disease')
else:
  print('The person does not have any heart disease')